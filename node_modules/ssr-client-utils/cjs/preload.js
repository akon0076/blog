"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.preloadComponent = void 0;
const path_to_regexp_1 = require("path-to-regexp");
const utils_1 = require("./utils");
const preloadComponent = async (Routes, BASE_NAME) => {
    // 预加载当前页面对应的组件
    for (const route of Routes) {
        const { component, path } = route;
        let activeComponent = component;
        if (window.__USE_VITE__) {
            route.component = (await activeComponent()).default;
        }
        else {
            let pathname = location.pathname;
            if (BASE_NAME) {
                pathname = utils_1.normalizePath(pathname, BASE_NAME);
            }
            if (activeComponent.preload && path_to_regexp_1.pathToRegexp(path).test(pathname)) {
                // 针对 react-loadble 包裹的组件
                activeComponent = (await activeComponent.preload()).default;
            }
            route.component = activeComponent;
        }
    }
    return Routes;
};
exports.preloadComponent = preloadComponent;
